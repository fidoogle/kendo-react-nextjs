{"ast":null,"code":"import _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar _jsxFileName = \"C:\\\\Users\\\\figuajardo\\\\Sites\\\\kendo-react-nextjs\\\\pages\\\\websocket.js\";\nimport React, { useState, useEffect } from 'react';\nimport Nav from '../components/nav';\nimport { w3cwebsocket as W3CWebSocket } from 'websocket';\nvar ws = new W3CWebSocket('wss://echo.websocket.org/');\n\nvar configureWs = function configureWs() {\n  ws.onopen = function () {\n    // on connecting, do nothing but log it to the console\n    console.log('connected');\n  };\n\n  ws.onmessage = function (evt) {\n    // may need to parse data sent from the websocket server\n    var message = JSON.parse(evt.data); //TODO: this.setState({dataFromServer: message})\n\n    console.log(message.month);\n  };\n\n  ws.onclose = function () {\n    console.log('disconnected'); //TODO: automatically try to reconnect on connection loss\n  };\n\n  sendMessages();\n};\n\nvar getRndInteger = function getRndInteger(min, max) {\n  var rnd = Math.floor(Math.random() * (max - min + 1)) + min;\n  return Math.round(rnd / 100) * 100; //rounds to nearest 100\n};\n\nvar buildMsg = function buildMsg() {\n  return _JSON$stringify({\n    month: \"Oct 19\",\n    volume: getRndInteger(500, 7500)\n  });\n};\n\nvar sendMessages = function sendMessages() {\n  var sendMsgs = setInterval(function () {\n    ws.send(buildMsg());\n  }, 2000);\n  setTimeout(function () {\n    clearInterval(sendMsgs);\n  }, 15000);\n};\n\nvar Main = function Main() {\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      dataFromServer = _useState2[0],\n      setDataFromServer = _useState2[1];\n\n  useEffect(function () {\n    return configureWs();\n  }, []);\n  return React.createElement(React.Fragment, null, React.createElement(Nav, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }, \"The websocket returned: \", dataFromServer));\n};\n\nexport default Main;","map":{"version":3,"sources":["C:/Users/figuajardo/Sites/kendo-react-nextjs/pages/websocket.js"],"names":["React","useState","useEffect","Nav","w3cwebsocket","W3CWebSocket","ws","configureWs","onopen","console","log","onmessage","evt","message","JSON","parse","data","month","onclose","sendMessages","getRndInteger","min","max","rnd","Math","floor","random","round","buildMsg","volume","sendMsgs","setInterval","send","setTimeout","clearInterval","Main","dataFromServer","setDataFromServer"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,GAAP,MAAgB,mBAAhB;AACA,SAASC,YAAY,IAAIC,YAAzB,QAA6C,WAA7C;AAEA,IAAMC,EAAE,GAAG,IAAID,YAAJ,CAAiB,2BAAjB,CAAX;;AAEA,IAAME,WAAW,GAAG,SAAdA,WAAc,GAAM;AACtBD,EAAAA,EAAE,CAACE,MAAH,GAAY,YAAM;AACd;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACH,GAHD;;AAKAJ,EAAAA,EAAE,CAACK,SAAH,GAAe,UAAAC,GAAG,EAAI;AAClB;AACA,QAAMC,OAAO,GAAGC,IAAI,CAACC,KAAL,CAAWH,GAAG,CAACI,IAAf,CAAhB,CAFkB,CAGlB;;AACAP,IAAAA,OAAO,CAACC,GAAR,CAAYG,OAAO,CAACI,KAApB;AACH,GALD;;AAOAX,EAAAA,EAAE,CAACY,OAAH,GAAa,YAAM;AACfT,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EADe,CAEf;AAEH,GAJD;;AAMAS,EAAAA,YAAY;AACf,CApBD;;AAsBA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,GAAD,EAAMC,GAAN,EAAc;AAChC,MAAMC,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBJ,GAAG,GAAGD,GAAN,GAAY,CAA7B,CAAX,IAA+CA,GAA3D;AACA,SAAOG,IAAI,CAACG,KAAL,CAAWJ,GAAG,GAAC,GAAf,IAAoB,GAA3B,CAFgC,CAEA;AACnC,CAHD;;AAKA,IAAMK,QAAQ,GAAG,SAAXA,QAAW,GAAM;AACnB,SAAO,gBAAe;AAAEX,IAAAA,KAAK,EAAE,QAAT;AAAmBY,IAAAA,MAAM,EAAET,aAAa,CAAC,GAAD,EAAM,IAAN;AAAxC,GAAf,CAAP;AACH,CAFD;;AAIA,IAAMD,YAAY,GAAG,SAAfA,YAAe,GAAM;AACvB,MAAMW,QAAQ,GAAGC,WAAW,CAAC,YAAM;AAAEzB,IAAAA,EAAE,CAAC0B,IAAH,CAAQJ,QAAQ,EAAhB;AAAqB,GAA9B,EAAgC,IAAhC,CAA5B;AACAK,EAAAA,UAAU,CAAC,YAAM;AAAEC,IAAAA,aAAa,CAACJ,QAAD,CAAb;AAAwB,GAAjC,EAAmC,KAAnC,CAAV;AACH,CAHD;;AAKA,IAAMK,IAAI,GAAG,SAAPA,IAAO,GAAM;AAAA,kBAC6BlC,QAAQ,CAAC,EAAD,CADrC;AAAA;AAAA,MACRmC,cADQ;AAAA,MACQC,iBADR;;AAEfnC,EAAAA,SAAS,CAAC;AAAA,WAAMK,WAAW,EAAjB;AAAA,GAAD,EAAsB,EAAtB,CAAT;AAEA,SACI,0CACI,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAC6B6B,cAD7B,CAFJ,CADJ;AAQH,CAZD;;AAcA,eAAeD,IAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Nav from '../components/nav';\r\nimport { w3cwebsocket as W3CWebSocket } from 'websocket';\r\n\r\nconst ws = new W3CWebSocket('wss://echo.websocket.org/');\r\n\r\nconst configureWs = () => {\r\n    ws.onopen = () => {\r\n        // on connecting, do nothing but log it to the console\r\n        console.log('connected')\r\n    }\r\n\r\n    ws.onmessage = evt => {\r\n        // may need to parse data sent from the websocket server\r\n        const message = JSON.parse(evt.data)\r\n        //TODO: this.setState({dataFromServer: message})\r\n        console.log(message.month);\r\n    }\r\n\r\n    ws.onclose = () => {\r\n        console.log('disconnected')\r\n        //TODO: automatically try to reconnect on connection loss\r\n\r\n    }\r\n\r\n    sendMessages();\r\n}\r\n\r\nconst getRndInteger = (min, max) => {\r\n    const rnd = Math.floor(Math.random() * (max - min + 1) ) + min;\r\n    return Math.round(rnd/100)*100; //rounds to nearest 100\r\n}\r\n\r\nconst buildMsg = () => {\r\n    return JSON.stringify({ month: \"Oct 19\", volume: getRndInteger(500, 7500) });\r\n}\r\n\r\nconst sendMessages = () => {\r\n    const sendMsgs = setInterval(() => { ws.send(buildMsg()) }, 2000);\r\n    setTimeout(() => { clearInterval(sendMsgs)}, 15000);\r\n}\r\n\r\nconst Main = () => {\r\n    const [dataFromServer, setDataFromServer] = useState('');\r\n    useEffect(() => configureWs(), []);\r\n\r\n    return (\r\n        <>\r\n            <Nav/>\r\n            <div>\r\n                The websocket returned: {dataFromServer}\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Main;\r\n"]},"metadata":{},"sourceType":"module"}