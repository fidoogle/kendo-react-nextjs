{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//Inspired from https://blog.logrocket.com/rxjs-with-react-hooks-for-state-management/\n//and https://rxjs.dev/api/webSocket/webSocket\nimport { webSocket } from 'rxjs/webSocket';\nvar subject = webSocket(\"wss://echo.websocket.org/\");\nvar initialState = {\n  data: [],\n  //array of objects like: [{month:\"Oct 19\", volume: 2500}, ... ]\n  newDataCount: 0\n};\nvar state = initialState;\nvar waterUsageStore = {\n  init: function init() {\n    state = _objectSpread({}, state, {\n      newDataCount: 0\n    });\n    subject.next(state);\n  },\n  subscribe: function subscribe(setState) {\n    return subject.subscribe(setState);\n  },\n  sendMessage: function sendMessage(message) {\n    state = _objectSpread({}, state, {\n      data: [].concat(_toConsumableArray(state.data), [message]),\n      newDataCount: state.newDataCount + 1\n    });\n    subject.next(state);\n  },\n  getCount: function getCount() {\n    return state.newDataCount;\n  },\n  initialState: initialState\n}; //These functions are used for mocking data that is echoed by the websocket\n\nvar getRndInteger = function getRndInteger(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\nvar getNearest100 = function getNearest100(min, max) {\n  var rnd = getRndInteger(min, max);\n  return Math.round(rnd / 100) * 100; //rounds to nearest 100\n};\n\nvar buildMsg = function buildMsg() {\n  return {\n    month: \"Month \".concat(waterUsageStore.getCount()),\n    volume: getNearest100(500, 7500)\n  };\n};\n\nvar sendMessages = function sendMessages() {\n  //echo a message every 2 seconds\n  var sendMsgs = setInterval(function () {\n    waterUsageStore.sendMessage(buildMsg());\n  }, 2000); //stop echoing after 30 seconds\n\n  setTimeout(function () {\n    clearInterval(sendMsgs);\n  }, 30000);\n};\n\nexport { waterUsageStore, sendMessages };","map":{"version":3,"sources":["C:/Users/figuajardo/Sites/kendo-react-nextjs/store/water-usage.js"],"names":["webSocket","subject","initialState","data","newDataCount","state","waterUsageStore","init","next","subscribe","setState","sendMessage","message","getCount","getRndInteger","min","max","Math","floor","random","getNearest100","rnd","round","buildMsg","month","volume","sendMessages","sendMsgs","setInterval","setTimeout","clearInterval"],"mappings":";;AAAA;AACA;AAEA,SAASA,SAAT,QAA0B,gBAA1B;AAEA,IAAMC,OAAO,GAAGD,SAAS,CAAC,2BAAD,CAAzB;AAGA,IAAME,YAAY,GAAG;AACjBC,EAAAA,IAAI,EAAE,EADW;AACP;AACVC,EAAAA,YAAY,EAAE;AAFG,CAArB;AAKA,IAAIC,KAAK,GAAGH,YAAZ;AAEA,IAAMI,eAAe,GAAG;AACpBC,EAAAA,IAAI,EAAE,gBAAM;AACRF,IAAAA,KAAK,qBAAOA,KAAP;AAAcD,MAAAA,YAAY,EAAE;AAA5B,MAAL;AACAH,IAAAA,OAAO,CAACO,IAAR,CAAaH,KAAb;AACH,GAJmB;AAMpBI,EAAAA,SAAS,EAAE,mBAAAC,QAAQ;AAAA,WAAIT,OAAO,CAACQ,SAAR,CAAkBC,QAAlB,CAAJ;AAAA,GANC;AAQpBC,EAAAA,WAAW,EAAE,qBAAAC,OAAO,EAAI;AACpBP,IAAAA,KAAK,qBACEA,KADF;AAEDF,MAAAA,IAAI,+BAAME,KAAK,CAACF,IAAZ,IAAkBS,OAAlB,EAFH;AAGDR,MAAAA,YAAY,EAAEC,KAAK,CAACD,YAAN,GAAqB;AAHlC,MAAL;AAKAH,IAAAA,OAAO,CAACO,IAAR,CAAaH,KAAb;AACH,GAfmB;AAiBpBQ,EAAAA,QAAQ,EAAE;AAAA,WAAMR,KAAK,CAACD,YAAZ;AAAA,GAjBU;AAmBpBF,EAAAA,YAAY,EAAZA;AAnBoB,CAAxB,C,CAuBA;;AACA,IAAMY,aAAa,GAAG,SAAhBA,aAAgB,CAACC,GAAD,EAAMC,GAAN,EAAc;AAChC,SAAOC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBH,GAAG,GAAGD,GAAN,GAAY,CAA7B,CAAX,IAA+CA,GAAtD;AACH,CAFD;;AAGA,IAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACL,GAAD,EAAMC,GAAN,EAAc;AAChC,MAAMK,GAAG,GAAGP,aAAa,CAACC,GAAD,EAAMC,GAAN,CAAzB;AACA,SAAOC,IAAI,CAACK,KAAL,CAAWD,GAAG,GAAC,GAAf,IAAoB,GAA3B,CAFgC,CAEA;AACnC,CAHD;;AAIA,IAAME,QAAQ,GAAG,SAAXA,QAAW,GAAM;AACnB,SAAQ;AAAEC,IAAAA,KAAK,kBAAWlB,eAAe,CAACO,QAAhB,EAAX,CAAP;AAAgDY,IAAAA,MAAM,EAAEL,aAAa,CAAC,GAAD,EAAM,IAAN;AAArE,GAAR;AACH,CAFD;;AAGA,IAAMM,YAAY,GAAG,SAAfA,YAAe,GAAM;AACvB;AACA,MAAMC,QAAQ,GAAGC,WAAW,CAAC,YAAM;AAAEtB,IAAAA,eAAe,CAACK,WAAhB,CAA4BY,QAAQ,EAApC;AAAyC,GAAlD,EAAoD,IAApD,CAA5B,CAFuB,CAGvB;;AACAM,EAAAA,UAAU,CAAC,YAAM;AAAEC,IAAAA,aAAa,CAACH,QAAD,CAAb;AAAwB,GAAjC,EAAmC,KAAnC,CAAV;AACH,CALD;;AAQA,SAASrB,eAAT,EAA0BoB,YAA1B","sourcesContent":["//Inspired from https://blog.logrocket.com/rxjs-with-react-hooks-for-state-management/\r\n//and https://rxjs.dev/api/webSocket/webSocket\r\n\r\nimport { webSocket } from 'rxjs/webSocket';\r\n\r\nconst subject = webSocket(\"wss://echo.websocket.org/\");\r\n\r\n\r\nconst initialState = {\r\n    data: [], //array of objects like: [{month:\"Oct 19\", volume: 2500}, ... ]\r\n    newDataCount: 0 \r\n};\r\n\r\nlet state = initialState;\r\n\r\nconst waterUsageStore = {\r\n    init: () => {\r\n        state = {...state, newDataCount: 0};\r\n        subject.next(state);\r\n    },\r\n\r\n    subscribe: setState => subject.subscribe(setState),\r\n\r\n    sendMessage: message => {\r\n        state = {\r\n            ...state,\r\n            data: [...state.data, message],\r\n            newDataCount: state.newDataCount + 1\r\n        };\r\n        subject.next(state);\r\n    },\r\n\r\n    getCount: () => state.newDataCount,\r\n\r\n    initialState\r\n};\r\n\r\n\r\n//These functions are used for mocking data that is echoed by the websocket\r\nconst getRndInteger = (min, max) => {\r\n    return Math.floor(Math.random() * (max - min + 1) ) + min;\r\n}\r\nconst getNearest100 = (min, max) => {\r\n    const rnd = getRndInteger(min, max);\r\n    return Math.round(rnd/100)*100; //rounds to nearest 100\r\n}\r\nconst buildMsg = () => {\r\n    return ({ month: `Month ${waterUsageStore.getCount()}`, volume: getNearest100(500, 7500) });\r\n}\r\nconst sendMessages = () => {\r\n    //echo a message every 2 seconds\r\n    const sendMsgs = setInterval(() => { waterUsageStore.sendMessage(buildMsg()) }, 2000);\r\n    //stop echoing after 30 seconds\r\n    setTimeout(() => { clearInterval(sendMsgs)}, 30000);\r\n}\r\n\r\n\r\nexport { waterUsageStore, sendMessages }"]},"metadata":{},"sourceType":"module"}