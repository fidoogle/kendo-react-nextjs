{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//Inspired from https://blog.logrocket.com/rxjs-with-react-hooks-for-state-management/\n//and https://rxjs.dev/api/webSocket/webSocket\nimport { webSocket } from 'rxjs/webSocket';\nvar subject = webSocket(\"wss://echo.websocket.org/\");\nvar initialState = {\n  data: [] //array of objects like: [{month:\"Oct 19\", volume: 2500}, ... ]\n\n};\nvar state = initialState;\nvar waterUsageStore = {\n  init: function init() {\n    //state = initialState; //{...state, data};\n    subject.next(state);\n  },\n  subscribe: function subscribe(setState) {\n    return subject.subscribe(setState);\n  },\n  sendMessage: function sendMessage(message) {\n    state = _objectSpread({}, state, {\n      data: [].concat(_toConsumableArray(state.data), [message])\n    });\n    subject.next(state);\n  },\n  initialState: initialState\n}; //These functions are used for mocking data that is echoed by the websocket\n\nvar getRndInteger = function getRndInteger(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\nvar getNearest100 = function getNearest100(min, max) {\n  var rnd = Math.floor(Math.random() * (max - min + 1)) + min;\n  return Math.round(rnd / 100) * 100; //rounds to nearest 100\n};\n\nvar buildMsg = function buildMsg() {\n  //return JSON.stringify({ month: \"Oct 19\", volume: getNearest100(500, 7500) });\n  return {\n    month: \"Month \".concat(getRndInteger(1, 12)),\n    volume: getNearest100(500, 7500)\n  };\n};\n\nvar sendMessages = function sendMessages() {\n  var sendMsgs = setInterval(function () {\n    waterUsageStore.sendMessage(buildMsg());\n  }, 2000);\n  setTimeout(function () {\n    clearInterval(sendMsgs);\n  }, 15000);\n};\n\nexport { waterUsageStore, sendMessages };","map":{"version":3,"sources":["C:/Users/figuajardo/Sites/kendo-react-nextjs/store/water-usage.js"],"names":["webSocket","subject","initialState","data","state","waterUsageStore","init","next","subscribe","setState","sendMessage","message","getRndInteger","min","max","Math","floor","random","getNearest100","rnd","round","buildMsg","month","volume","sendMessages","sendMsgs","setInterval","setTimeout","clearInterval"],"mappings":";;AAAA;AACA;AAEA,SAASA,SAAT,QAA0B,gBAA1B;AAEA,IAAMC,OAAO,GAAGD,SAAS,CAAC,2BAAD,CAAzB;AAGA,IAAME,YAAY,GAAG;AACjBC,EAAAA,IAAI,EAAE,EADW,CACR;;AADQ,CAArB;AAIA,IAAIC,KAAK,GAAGF,YAAZ;AAEA,IAAMG,eAAe,GAAG;AACpBC,EAAAA,IAAI,EAAE,gBAAM;AACR;AACAL,IAAAA,OAAO,CAACM,IAAR,CAAaH,KAAb;AACH,GAJmB;AAMpBI,EAAAA,SAAS,EAAE,mBAAAC,QAAQ;AAAA,WAAIR,OAAO,CAACO,SAAR,CAAkBC,QAAlB,CAAJ;AAAA,GANC;AAQpBC,EAAAA,WAAW,EAAE,qBAAAC,OAAO,EAAI;AACpBP,IAAAA,KAAK,qBACEA,KADF;AAEDD,MAAAA,IAAI,+BAAMC,KAAK,CAACD,IAAZ,IAAkBQ,OAAlB;AAFH,MAAL;AAIAV,IAAAA,OAAO,CAACM,IAAR,CAAaH,KAAb;AACH,GAdmB;AAgBpBF,EAAAA,YAAY,EAAZA;AAhBoB,CAAxB,C,CAoBA;;AACA,IAAMU,aAAa,GAAG,SAAhBA,aAAgB,CAACC,GAAD,EAAMC,GAAN,EAAc;AAChC,SAAOC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBH,GAAG,GAAGD,GAAN,GAAY,CAA7B,CAAX,IAA+CA,GAAtD;AACH,CAFD;;AAGA,IAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACL,GAAD,EAAMC,GAAN,EAAc;AAChC,MAAMK,GAAG,GAAGJ,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBH,GAAG,GAAGD,GAAN,GAAY,CAA7B,CAAX,IAA+CA,GAA3D;AACA,SAAOE,IAAI,CAACK,KAAL,CAAWD,GAAG,GAAC,GAAf,IAAoB,GAA3B,CAFgC,CAEA;AACnC,CAHD;;AAKA,IAAME,QAAQ,GAAG,SAAXA,QAAW,GAAM;AACnB;AACA,SAAQ;AAAEC,IAAAA,KAAK,kBAAWV,aAAa,CAAC,CAAD,EAAI,EAAJ,CAAxB,CAAP;AAA0CW,IAAAA,MAAM,EAAEL,aAAa,CAAC,GAAD,EAAM,IAAN;AAA/D,GAAR;AACH,CAHD;;AAKA,IAAMM,YAAY,GAAG,SAAfA,YAAe,GAAM;AACvB,MAAMC,QAAQ,GAAGC,WAAW,CAAC,YAAM;AAAErB,IAAAA,eAAe,CAACK,WAAhB,CAA4BW,QAAQ,EAApC;AAAyC,GAAlD,EAAoD,IAApD,CAA5B;AACAM,EAAAA,UAAU,CAAC,YAAM;AAAEC,IAAAA,aAAa,CAACH,QAAD,CAAb;AAAwB,GAAjC,EAAmC,KAAnC,CAAV;AACH,CAHD;;AAKA,SAASpB,eAAT,EAA0BmB,YAA1B","sourcesContent":["//Inspired from https://blog.logrocket.com/rxjs-with-react-hooks-for-state-management/\r\n//and https://rxjs.dev/api/webSocket/webSocket\r\n\r\nimport { webSocket } from 'rxjs/webSocket';\r\n\r\nconst subject = webSocket(\"wss://echo.websocket.org/\");\r\n\r\n\r\nconst initialState = {\r\n    data: [] //array of objects like: [{month:\"Oct 19\", volume: 2500}, ... ]\r\n};\r\n\r\nlet state = initialState;\r\n\r\nconst waterUsageStore = {\r\n    init: () => {\r\n        //state = initialState; //{...state, data};\r\n        subject.next(state);\r\n    },\r\n\r\n    subscribe: setState => subject.subscribe(setState),\r\n\r\n    sendMessage: message => {\r\n        state = {\r\n            ...state,\r\n            data: [...state.data, message]\r\n        };\r\n        subject.next(state);\r\n    },\r\n\r\n    initialState\r\n};\r\n\r\n\r\n//These functions are used for mocking data that is echoed by the websocket\r\nconst getRndInteger = (min, max) => {\r\n    return Math.floor(Math.random() * (max - min + 1) ) + min;\r\n}\r\nconst getNearest100 = (min, max) => {\r\n    const rnd = Math.floor(Math.random() * (max - min + 1) ) + min;\r\n    return Math.round(rnd/100)*100; //rounds to nearest 100\r\n}\r\n\r\nconst buildMsg = () => {\r\n    //return JSON.stringify({ month: \"Oct 19\", volume: getNearest100(500, 7500) });\r\n    return ({ month: `Month ${getRndInteger(1, 12)}`, volume: getNearest100(500, 7500) });\r\n}\r\n\r\nconst sendMessages = () => {\r\n    const sendMsgs = setInterval(() => { waterUsageStore.sendMessage(buildMsg()) }, 2000);\r\n    setTimeout(() => { clearInterval(sendMsgs)}, 15000);\r\n}\r\n\r\nexport { waterUsageStore, sendMessages }"]},"metadata":{},"sourceType":"module"}